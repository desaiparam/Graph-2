# Time Complexity : O(V^2) where V is the number of vertices in the graph
# Space Complexity : O(V) where V  is the number of vertices  in the graph
# Did this code successfully run on Leetcode : Yes
# Any problem you faced while coding this : No

# Your code here along with comments explaining your approach:
# I am using DFS to color the connected components of the graph.
# I maintain a colors array to keep track of the color assigned to each node.
# I also maintain a grp array to count the size of each connected component.
# I maintain an infected array to count the number of initially infected nodes in each component.
# After coloring the graph, I iterate through the initial infected nodes.
# For each node, if it is the only infected node in its component, I consider it for removal.
# I choose the node that maximizes the size of the component that would remain uninfected.
# If there is a tie, I choose the node with the smallest index.

from typing import List
class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        n = len(graph)
        colors = [-1] * n
        cl = 0
        def dfs(i,cl):
            if colors[i] != -1:
                return 
            colors[i] = cl
            for j in range(n):
                if i == j:
                    continue
                if graph[i][j] == 1:
                    dfs(j,cl)
        for i in range(n):
            dfs(i,cl)
            cl += 1
        grp = [0] * n
        for i in colors:
            grp[i] += 1
        infected = [0] * cl 
        for i in initial:
            infected[colors[i]] += 1
        res = float('inf')
        for i in initial:
            if infected[colors[i]] == 1:
                if res == float('inf'):
                    res = i
                elif grp[colors[i]] > grp[colors[res]]:
                    res = i
                elif grp[colors[i]] == grp[colors[res]]:
                    res = min(res,i)
        if res == float('inf'):
            res = min(initial)
        return res



        